{"version":3,"file":"index-DyAX5SD_.js","sources":["../../../app/administration/src/module/payone-payment/component/payone-ratepay-profiles/payone-ratepay-profiles.html.twig","../../../app/administration/src/module/payone-payment/component/payone-ratepay-profiles/index.js"],"sourcesContent":["{% block payone_ratepay_profiles %}\n    <div class=\"payone-ratepay-profiles\">\n        {% block payone_ratepay_shop_ids %}\n            <h3>\n                {{ $t('payone-payment.general.headlines.ratepayProfiles') }}\n            </h3>\n\n            <sw-container\n                slot=\"grid\"\n                type=\"row\"\n                class\n            >\n                {% block payone_ratepay_shop_ids_actions %}\n                    <sw-container\n                        class=\"sw-card__toolbar\"\n                        columns=\"1fr\"\n                    >\n                        {% block payone_ratepay_shop_ids_create_actions %}\n                            <div align=\"right\">\n                                <mt-button\n                                    class\n                                    size=\"small\"\n                                    @click=\"createNewLineItem\"\n                                    variant=\"primary\"\n                                >\n                                    {{ $t('payone-payment.general.actions.addShop') }}\n                                </mt-button>\n                            </div>\n                        {% endblock %}\n                    </sw-container>\n                {% endblock %}\n\n                {% block payone_ratepay_shop_ids_grid %}\n                    <sw-data-grid\n                        v-if=\"value\"\n                        ref=\"shopIdsDataGrid\"\n                        :dataSource=\"profiles\"\n                        :columns=\"getLineItemColumns\"\n                        :fullPage=\"false\"\n                        :showSettings=\"false\"\n                        :showSelection=\"false\"\n                        :showActions=\"true\"\n                        :allowColumnEdit=\"false\"\n                        :allowInlineEdit=\"true\"\n                        :compactMode=\"true\"\n                        identifier=\"sw-order-line-item-grid\"\n                        class=\"sw-order-line-items-grid__data-grid\"\n                        @inline-edit-save=\"onInlineEditSave\"\n                        @inline-edit-cancel=\"onInlineEditCancel\"\n                    >\n                        {% block payone_ratepay_shop_ids_grid_columns %}\n                            {% block payone_ratepay_shop_ids_grid_column_status %}\n                                <template #column-error=\"{ item, column }\">\n                                    <mt-icon\n                                        v-tooltip=\"{\n                                            message: item.error,\n                                            width: 150,\n                                            position: 'bottom'\n                                        }\"\n                                        v-if=\"item.error\"\n                                        name=\"regular-exclamation-triangle\"\n                                        color=\"red\"\n                                        size=\"24px\"\n                                    >\n                                    </mt-icon>\n                                </template>\n                            {% endblock %}\n\n                            {% block payone_ratepay_shop_ids_bulk_actions %}\n                                <template #actions=\"{ item }\">\n                                    {% block sw_settings_units_content_grid_column_menu_delete %}\n                                        <sw-context-menu-item\n                                            @click=\"onDeleteSelectedItem(item)\"\n                                            variant=\"danger\"\n                                        >\n                                            {{ $t('global.default.delete') }}\n                                        </sw-context-menu-item>\n                                    {% endblock %}\n                                </template>\n                            {% endblock %}\n                        {% endblock %}\n                    </sw-data-grid>\n                {% endblock %}\n\n                {% block payone_ratepay_shop_ids_error %}\n                    <mt-banner\n                        v-if=\"showDuplicateAlert\"\n                        variant=\"critical\"\n                    >\n                        {{ $t('payone-payment.general.errors.existingShopId') }}\n                    </mt-banner>\n\n                    <mt-banner\n                        v-if=\"showEmptyAlert\"\n                        variant=\"critical\"\n                    >\n                        {{ $t('payone-payment.general.errors.emptyInputs') }}\n                    </mt-banner>\n                {% endblock %}\n            </sw-container>\n        {% endblock %}\n    </div>\n{% endblock %}","import './payone-ratepay-profiles.scss';\nimport template from './payone-ratepay-profiles.html.twig';\n\nconst { Utils } = Shopware;\n\nexport default {\n    template,\n\n    props: {\n        value: {\n            type: Array,\n            required: false,\n            default() {\n                return [];\n            }\n        },\n        name: {\n            type: String,\n            required: true\n        },\n    },\n\n    data() {\n        return {\n            selectedItems: {},\n            newItem: null,\n            showDuplicateAlert: false,\n            showEmptyAlert: false,\n            profiles: this.value,\n        };\n    },\n\n    computed: {\n        getLineItemColumns() {\n            return [{\n                property: 'shopId',\n                dataIndex: 'shopId',\n                label: this.$t('payone-payment.general.label.shopId'),\n                allowResize: false,\n                inlineEdit: 'string',\n                width: '200px',\n                primary: true,\n            }, {\n                property: 'currency',\n                dataIndex: 'currency',\n                label: this.$t('payone-payment.general.label.currency'),\n                allowResize: false,\n                inlineEdit: 'string',\n                width: '200px',\n                primary: true,\n            }, {\n                property: 'error',\n                label: this.$t('payone-payment.general.label.error'),\n                allowResize: false,\n                width: '100px',\n                primary: true,\n            }];\n        }\n    },\n\n    watch: {\n        profiles(profiles) {\n            this.$emit('update:value', profiles);\n            this.$emit('input', profiles); // required for SW 6.5.x compatibility\n            this.$emit('change', profiles); // required for SW 6.5.x compatibility\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    destroyed() {\n        this.destroyedComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            Shopware.Utils.EventBus.on('payone-ratepay-profiles-update-result', this.onProfilesUpdateResult);\n        },\n\n        destroyedComponent() {\n            Shopware.Utils.EventBus.off('payone-ratepay-profiles-update-result');\n        },\n\n        onProfilesUpdateResult(result) {\n            if (result['updates'][this.name]) {\n                this.profiles = result['updates'][this.name];\n            }\n            if (result['errors'][this.name]) {\n                for (const error of result['errors'][this.name]) {\n                    this.profiles.push(error);\n                }\n            }\n        },\n\n        onInlineEditCancel(currentItem) {\n            if(currentItem.shopId === \"\" && currentItem.currency === \"\") {\n                this.profiles.forEach(function(item, index, array) {\n                    if(item.id === currentItem.id) {\n                        array.splice(index, 1);\n                    }\n                });\n            }\n\n            this.$emit('item-cancel');\n        },\n\n        onInlineEditSave(currentItem) {\n            if(currentItem.shopId !== \"\" && currentItem.currency !== \"\") {\n                this.showEmptyAlert = false;\n                let shopIdExists = false;\n                this.profiles.forEach(function(item) {\n                    if(item.id !== currentItem.id && item.shopId === currentItem.shopId) {\n                        shopIdExists = true;\n                    }\n                });\n\n                if(shopIdExists) {\n                  this.showDuplicateAlert = true;\n\n                  this.$nextTick(() => {\n                    this.$refs.shopIdsDataGrid.currentInlineEditId = currentItem.id;\n                    this.$refs.shopIdsDataGrid.enableInlineEdit();\n                  });\n                } else {\n                  this.showDuplicateAlert = false;\n                }\n            } else {\n                this.showEmptyAlert = true;\n\n                this.$nextTick(() => {\n                    this.$refs.shopIdsDataGrid.currentInlineEditId = currentItem.id;\n                    this.$refs.shopIdsDataGrid.enableInlineEdit();\n                });\n            }\n\n            this.$emit('update-list', this.profiles);\n        },\n\n        createNewLineItem() {\n            let emptyProfilesList = false;\n\n            emptyProfilesList = this.profiles.length === 0;\n\n            if(emptyProfilesList) {\n                this.createLine();\n                return;\n            }\n\n            if(this.profiles[this.profiles.length - 1].shopId !== \"\") {\n                this.createLine();\n            }\n        },\n\n        createLine() {\n            const newId = Utils.createId();\n\n            this.profiles.push({'id': newId, 'shopId': '', 'currency': '' });\n\n            this.$nextTick(() => {\n                this.$refs.shopIdsDataGrid.currentInlineEditId = newId;\n                this.$refs.shopIdsDataGrid.enableInlineEdit();\n            });\n        },\n\n        onDeleteSelectedItem(itemToDelete) {\n            this.profiles = this.profiles.filter(currentItem => currentItem.shopId !== itemToDelete.shopId);\n\n            this.$emit('deleted', this.profiles);\n        },\n    }\n};\n"],"names":["template","Utils","index","profiles","result","error","currentItem","item","array","shopIdExists","emptyProfilesList","newId","itemToDelete"],"mappings":"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"}