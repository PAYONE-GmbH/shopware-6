{"version":3,"file":"static/js/6ac7e1a516c00c6bd566.js","mappings":"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","sources":["webpack://administration/../../../../../../custom/plugins/PayonePayment/src/Resources/app/administration/src/module/sw-order/component/payone-refund-button/index.js","webpack://administration/../../../../../../custom/plugins/PayonePayment/src/Resources/app/administration/src/module/sw-order/component/payone-refund-button/payone-refund-button.html.twig","webpack://administration/../../../../../../custom/plugins/PayonePayment/src/Resources/app/administration/src/module/sw-order/component/payone-refund-button/payone-refund-button.scss?6e6a","webpack://administration/./node_modules/vue-style-loader/lib/listToStyles.js","webpack://administration/./node_modules/vue-style-loader/lib/addStylesClient.js"],"sourcesContent":["import template from './payone-refund-button.html.twig';\nimport './payone-refund-button.scss';\n\nconst {Mixin, Filter} = Shopware;\n\nexport default {\n    template,\n\n    mixins: [\n        Mixin.getByName('notification')\n    ],\n\n    inject: ['PayonePaymentService'],\n\n    props: {\n        order: {\n            type: Object,\n            required: true\n        },\n        transaction: {\n            type: Object,\n            required: true\n        }\n    },\n\n    data() {\n        return {\n            isLoading: false,\n            hasError: false,\n            showRefundModal: false,\n            isRefundSuccessful: false,\n            refundAmount: 0.0,\n            includeShippingCosts: false,\n            items: [],\n        };\n    },\n\n    computed: {\n        currencyFilter() {\n            return Filter.getByName('currency');\n        },\n\n        payoneCurrencyFilter() {\n            return Filter.getByName('payone_currency');\n        },\n\n        decimalPrecision() {\n            if (!this.order || !this.order.currency) {\n                return 2;\n            }\n            if (this.order.currency.decimalPrecision) {\n                return this.order.currency.decimalPrecision;\n            }\n            if (this.order.currency.itemRounding) {\n                return this.order.currency.itemRounding.decimals;\n            }\n        },\n\n        remainingAmount() {\n            const data = this.transaction?.extensions?.payonePaymentOrderTransactionData ?? {};\n            return (data.capturedAmount ?? 0) - (data.refundedAmount ?? 0);\n        },\n\n        refundedAmount() {\n            return this.transaction?.extensions?.payonePaymentOrderTransactionData?.refundedAmount ?? 0;\n        },\n\n        maxRefundAmount() {\n            return this.remainingAmount / (10 ** this.decimalPrecision);\n        },\n\n        buttonEnabled() {\n            if (!this.transaction?.extensions?.payonePaymentOrderTransactionData) {\n                return false;\n            }\n\n            return (this.remainingAmount > 0 && this.refundedAmount > 0) || this.transaction.extensions.payonePaymentOrderTransactionData.allowRefund;\n        },\n\n        selectedItems() {\n            return this.items.filter(item => item.selected && item.quantity > 0);\n        },\n\n        hasRemainingRefundableShippingCosts() {\n            if (this.order.shippingCosts.totalPrice <= 0) {\n                return false;\n            }\n\n            const shippingCosts = this.order.shippingCosts.totalPrice * (10 ** this.decimalPrecision);\n\n            let refundedPositionAmount = 0;\n\n            this.order.lineItems.forEach((order_item) => {\n                if (order_item.customFields && order_item.customFields.payone_refunded_quantity\n                    && 0 < order_item.customFields.payone_refunded_quantity) {\n                    refundedPositionAmount += order_item.customFields.payone_refunded_quantity * order_item.unitPrice * (10 ** this.decimalPrecision);\n                }\n            });\n\n            return this.refundedAmount - Math.round(refundedPositionAmount) < shippingCosts;\n        }\n    },\n\n    methods: {\n        calculateActionAmount() {\n            let amount = 0;\n\n            this.selectedItems.forEach((selection) => {\n                amount += selection.unit_price * selection.quantity;\n            });\n\n            this.refundAmount = amount > this.remainingAmount ? this.remainingAmount : amount;\n        },\n\n        openRefundModal() {\n            this.showRefundModal = true;\n            this.isRefundSuccessful = false;\n            this.initItems();\n        },\n\n        initItems() {\n            this.items = this.order.lineItems.map((orderItem) => {\n                // note: if the order got captured during the payment (direct authorize instead of pre-authorize), the field `payone_captured_quantity` will be empty.\n                // in this case we are using the ordered quantity\n                const qty = this.getRefundableQuantityOfItem(orderItem);\n\n                return {\n                    id: orderItem.id,\n                    quantity: qty,\n                    maxQuantity: qty,\n                    unit_price: orderItem.unitPrice,\n                    selected: false,\n                    product: orderItem.label,\n                    disabled: qty <= 0,\n                };\n            });\n\n            if (this.order.shippingCosts.totalPrice > 0) {\n                this.items.push({\n                    id: 'shipping',\n                    quantity: 1,\n                    maxQuantity: 1,\n                    unit_price: this.order.shippingCosts.totalPrice,\n                    selected: false,\n                    disabled: false,\n                    product: this.$tc('sw-order.payone-payment.modal.shippingCosts'),\n                });\n            }\n        },\n\n        closeRefundModal() {\n            this.showRefundModal = false;\n        },\n\n        onRefundFinished() {\n            this.isRefundSuccessful = false;\n        },\n\n        refundOrder() {\n            const request = {\n                orderTransactionId: this.transaction.id,\n                payone_order_id: this.transaction.extensions.payonePaymentOrderTransactionData.transactionId,\n                salesChannel: this.order.salesChannel,\n                amount: this.refundAmount,\n                orderLines: [],\n                complete: this.refundAmount === this.maxRefundAmount,\n                includeShippingCosts: false\n            };\n\n            this.isLoading = true;\n\n            this.selectedItems.forEach((selection) => {\n                if (selection.id === 'shipping') {\n                    request.includeShippingCosts = true;\n                } else {\n                    const orderLineItem = this.order.lineItems.find(lineItem => lineItem.id === selection.id);\n                    if (orderLineItem) {\n                        const copy = {...orderLineItem};\n                        const taxRate = copy.tax_rate / (10 ** request.decimalPrecision);\n\n                        copy.quantity = selection.quantity;\n                        copy.total_amount = copy.unit_price * copy.quantity;\n                        copy.total_tax_amount = Math.round(copy.total_amount / (100 + taxRate) * taxRate);\n\n                        request.orderLines.push(copy);\n                    }\n                }\n            });\n\n            if (this.remainingAmount < (request.amount * (10 ** this.decimalPrecision))) {\n                request.amount = this.remainingAmount / (10 ** this.decimalPrecision);\n            }\n\n            this.executeRefund(request);\n        },\n\n        getRefundableQuantityOfItem(orderItem) {\n            return (orderItem.customFields?.payone_captured_quantity ?? orderItem.quantity) - (orderItem.customFields?.payone_refunded_quantity ?? 0);\n        },\n\n        refundFullOrder() {\n            const request = {\n                orderTransactionId: this.transaction.id,\n                payone_order_id: this.transaction.extensions.payonePaymentOrderTransactionData.transactionId,\n                salesChannel: this.order.salesChannel,\n                amount: this.maxRefundAmount,\n                orderLines: [],\n                complete: true,\n                includeShippingCosts: this.hasRemainingRefundableShippingCosts\n            };\n\n            this.isLoading = true;\n\n            request.orderLines = this.order.lineItems.map((orderItem) => {\n                return {\n                    id: orderItem.id,\n                    quantity: this.getRefundableQuantityOfItem(orderItem),\n                    unit_price: orderItem.unitPrice,\n                    selected: false\n                };\n            });\n\n            this.executeRefund(request);\n        },\n\n        executeRefund(request) {\n            this.PayonePaymentService.refundPayment(request).then(() => {\n                this.createNotificationSuccess({\n                    title: this.$tc('sw-order.payone-payment.refund.successTitle'),\n                    message: this.$tc('sw-order.payone-payment.refund.successMessage')\n                });\n\n                this.isRefundSuccessful = true;\n            }).catch((error) => {\n                this.createNotificationError({\n                    title: this.$tc('sw-order.payone-payment.refund.errorTitle'),\n                    message: error.message\n                });\n\n                this.isRefundSuccessful = false;\n            }).finally(() => {\n                this.isLoading = false;\n                this.closeRefundModal();\n\n                this.$nextTick().then(() => {\n                    this.$emit('reload')\n                });\n            });\n        },\n    },\n    watch: {\n        items: {\n            handler() {\n                this.calculateActionAmount();\n            },\n            deep: true,\n        }\n    }\n};\n","export default \"{% block payone_payment_payment_details %}\\n    <div class=\\\"payone-refund-button\\\">\\n        <sw-container v-tooltip=\\\"{message: $tc('sw-order.payone-payment.refund.tooltips.impossible'), disabled: buttonEnabled}\\\" :key=\\\"buttonEnabled\\\">\\n            <sw-button :disabled=\\\"!buttonEnabled\\\" @click=\\\"openRefundModal\\\">\\n                {{ $tc('sw-order.payone-payment.refund.buttonTitle') }}\\n            </sw-button>\\n        </sw-container>\\n\\n        <sw-modal v-if=\\\"showRefundModal\\\" @modal-close=\\\"closeRefundModal\\\" :title=\\\"$tc(`sw-order.payone-payment.modal.refund.title`)\\\" class=\\\"payone-payment-detail--refund-modal\\\">\\n            <payone-order-items :order=\\\"order\\\" :items=\\\"items\\\"></payone-order-items>\\n\\n            <div class=\\\"payone-payment-detail--refund-modal--content\\\">\\n                <sw-container columns=\\\"1fr 1fr\\\" gap=\\\"0 32px\\\">\\n                    <sw-text-field :disabled=\\\"true\\\" :label=\\\"$tc('sw-order.payone-payment.modal.orderAmount')\\\" :value=\\\"currencyFilter(transaction.amount.totalPrice, order.currency.shortName)\\\"></sw-text-field>\\n                    <sw-text-field :disabled=\\\"true\\\" :label=\\\"$tc('sw-order.payone-payment.modal.refund.refunded')\\\" :value=\\\"payoneCurrencyFilter(refundedAmount, order.currency.shortName)\\\"></sw-text-field>\\n                    <sw-text-field :disabled=\\\"true\\\" :label=\\\"$tc('sw-order.payone-payment.modal.remainingAmount')\\\" :value=\\\"payoneCurrencyFilter(remainingAmount, order.currency.shortName)\\\"></sw-text-field>\\n                    <sw-number-field required=\\\"required\\\" numberType=\\\"float\\\" :digits=\\\"order.decimal_precision\\\" :label=\\\"$tc('sw-order.payone-payment.modal.refund.amount')\\\"\\n                                     v-model:value=\\\"refundAmount\\\"\\n                                     :min=\\\"0\\\"\\n                                     :max=\\\"maxRefundAmount\\\"></sw-number-field>\\n                </sw-container>\\n            </div>\\n\\n            <template #modal-footer>\\n                <sw-button :disabled=\\\"isLoading\\\" @click=\\\"closeRefundModal\\\">\\n                    {{ $tc('sw-order.payone-payment.modal.close') }}\\n                </sw-button>\\n\\n                <sw-button-process :isLoading=\\\"isLoading\\\" :processSuccess=\\\"isRefundSuccessful\\\" @process-finish=\\\"onRefundFinished()\\\" :disabled=\\\"isLoading || refundAmount <= 0\\\" variant=\\\"primary\\\" @click=\\\"refundOrder\\\">\\n                    {{ $tc('sw-order.payone-payment.modal.refund.submit') }}\\n                </sw-button-process>\\n\\n                <sw-button-process :isLoading=\\\"isLoading\\\" :processSuccess=\\\"isRefundSuccessful\\\" @process-finish=\\\"onRefundFinished()\\\" :disabled=\\\"isLoading\\\" variant=\\\"primary\\\" @click=\\\"refundFullOrder\\\">\\n                    {{ $tc('sw-order.payone-payment.modal.refund.fullSubmit') }}\\n                </sw-button-process>\\n            </template>\\n        </sw-modal>\\n    </div>\\n{% endblock %}\\n\";","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../../../../../../vendor/shopware/administration/Resources/app/administration/node_modules/mini-css-extract-plugin/dist/loader.js??ruleSet[1].rules[12].use[1]!../../../../../../../../../../../../vendor/shopware/administration/Resources/app/administration/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[12].use[2]!../../../../../../../../../../../../vendor/shopware/administration/Resources/app/administration/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[12].use[3]!./payone-refund-button.scss\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../../../../../../vendor/shopware/administration/Resources/app/administration/node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"afa32006\", content, true, {});","/**\n * Translates the list format produced by css-loader into something\n * easier to manipulate.\n */\nexport default function listToStyles (parentId, list) {\n  var styles = []\n  var newStyles = {}\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i]\n    var id = item[0]\n    var css = item[1]\n    var media = item[2]\n    var sourceMap = item[3]\n    var part = {\n      id: parentId + ':' + i,\n      css: css,\n      media: media,\n      sourceMap: sourceMap\n    }\n    if (!newStyles[id]) {\n      styles.push(newStyles[id] = { id: id, parts: [part] })\n    } else {\n      newStyles[id].parts.push(part)\n    }\n  }\n  return styles\n}\n","/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n  Modified by Evan You @yyx990803\n*/\n\nimport listToStyles from './listToStyles'\n\nvar hasDocument = typeof document !== 'undefined'\n\nif (typeof DEBUG !== 'undefined' && DEBUG) {\n  if (!hasDocument) {\n    throw new Error(\n    'vue-style-loader cannot be used in a non-browser environment. ' +\n    \"Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.\"\n  ) }\n}\n\n/*\ntype StyleObject = {\n  id: number;\n  parts: Array<StyleObjectPart>\n}\n\ntype StyleObjectPart = {\n  css: string;\n  media: string;\n  sourceMap: ?string\n}\n*/\n\nvar stylesInDom = {/*\n  [id: number]: {\n    id: number,\n    refs: number,\n    parts: Array<(obj?: StyleObjectPart) => void>\n  }\n*/}\n\nvar head = hasDocument && (document.head || document.getElementsByTagName('head')[0])\nvar singletonElement = null\nvar singletonCounter = 0\nvar isProduction = false\nvar noop = function () {}\nvar options = null\nvar ssrIdKey = 'data-vue-ssr-id'\n\n// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n// tags it will allow on a page\nvar isOldIE = typeof navigator !== 'undefined' && /msie [6-9]\\b/.test(navigator.userAgent.toLowerCase())\n\nexport default function addStylesClient (parentId, list, _isProduction, _options) {\n  isProduction = _isProduction\n\n  options = _options || {}\n\n  var styles = listToStyles(parentId, list)\n  addStylesToDom(styles)\n\n  return function update (newList) {\n    var mayRemove = []\n    for (var i = 0; i < styles.length; i++) {\n      var item = styles[i]\n      var domStyle = stylesInDom[item.id]\n      domStyle.refs--\n      mayRemove.push(domStyle)\n    }\n    if (newList) {\n      styles = listToStyles(parentId, newList)\n      addStylesToDom(styles)\n    } else {\n      styles = []\n    }\n    for (var i = 0; i < mayRemove.length; i++) {\n      var domStyle = mayRemove[i]\n      if (domStyle.refs === 0) {\n        for (var j = 0; j < domStyle.parts.length; j++) {\n          domStyle.parts[j]()\n        }\n        delete stylesInDom[domStyle.id]\n      }\n    }\n  }\n}\n\nfunction addStylesToDom (styles /* Array<StyleObject> */) {\n  for (var i = 0; i < styles.length; i++) {\n    var item = styles[i]\n    var domStyle = stylesInDom[item.id]\n    if (domStyle) {\n      domStyle.refs++\n      for (var j = 0; j < domStyle.parts.length; j++) {\n        domStyle.parts[j](item.parts[j])\n      }\n      for (; j < item.parts.length; j++) {\n        domStyle.parts.push(addStyle(item.parts[j]))\n      }\n      if (domStyle.parts.length > item.parts.length) {\n        domStyle.parts.length = item.parts.length\n      }\n    } else {\n      var parts = []\n      for (var j = 0; j < item.parts.length; j++) {\n        parts.push(addStyle(item.parts[j]))\n      }\n      stylesInDom[item.id] = { id: item.id, refs: 1, parts: parts }\n    }\n  }\n}\n\nfunction createStyleElement () {\n  var styleElement = document.createElement('style')\n  styleElement.type = 'text/css'\n  head.appendChild(styleElement)\n  return styleElement\n}\n\nfunction addStyle (obj /* StyleObjectPart */) {\n  var update, remove\n  var styleElement = document.querySelector('style[' + ssrIdKey + '~=\"' + obj.id + '\"]')\n\n  if (styleElement) {\n    if (isProduction) {\n      // has SSR styles and in production mode.\n      // simply do nothing.\n      return noop\n    } else {\n      // has SSR styles but in dev mode.\n      // for some reason Chrome can't handle source map in server-rendered\n      // style tags - source maps in <style> only works if the style tag is\n      // created and inserted dynamically. So we remove the server rendered\n      // styles and inject new ones.\n      styleElement.parentNode.removeChild(styleElement)\n    }\n  }\n\n  if (isOldIE) {\n    // use singleton mode for IE9.\n    var styleIndex = singletonCounter++\n    styleElement = singletonElement || (singletonElement = createStyleElement())\n    update = applyToSingletonTag.bind(null, styleElement, styleIndex, false)\n    remove = applyToSingletonTag.bind(null, styleElement, styleIndex, true)\n  } else {\n    // use multi-style-tag mode in all other cases\n    styleElement = createStyleElement()\n    update = applyToTag.bind(null, styleElement)\n    remove = function () {\n      styleElement.parentNode.removeChild(styleElement)\n    }\n  }\n\n  update(obj)\n\n  return function updateStyle (newObj /* StyleObjectPart */) {\n    if (newObj) {\n      if (newObj.css === obj.css &&\n          newObj.media === obj.media &&\n          newObj.sourceMap === obj.sourceMap) {\n        return\n      }\n      update(obj = newObj)\n    } else {\n      remove()\n    }\n  }\n}\n\nvar replaceText = (function () {\n  var textStore = []\n\n  return function (index, replacement) {\n    textStore[index] = replacement\n    return textStore.filter(Boolean).join('\\n')\n  }\n})()\n\nfunction applyToSingletonTag (styleElement, index, remove, obj) {\n  var css = remove ? '' : obj.css\n\n  if (styleElement.styleSheet) {\n    styleElement.styleSheet.cssText = replaceText(index, css)\n  } else {\n    var cssNode = document.createTextNode(css)\n    var childNodes = styleElement.childNodes\n    if (childNodes[index]) styleElement.removeChild(childNodes[index])\n    if (childNodes.length) {\n      styleElement.insertBefore(cssNode, childNodes[index])\n    } else {\n      styleElement.appendChild(cssNode)\n    }\n  }\n}\n\nfunction applyToTag (styleElement, obj) {\n  var css = obj.css\n  var media = obj.media\n  var sourceMap = obj.sourceMap\n\n  if (media) {\n    styleElement.setAttribute('media', media)\n  }\n  if (options.ssrId) {\n    styleElement.setAttribute(ssrIdKey, obj.id)\n  }\n\n  if (sourceMap) {\n    // https://developer.chrome.com/devtools/docs/javascript-debugging\n    // this makes source maps inside style tags work properly in Chrome\n    css += '\\n/*# sourceURL=' + sourceMap.sources[0] + ' */'\n    // http://stackoverflow.com/a/26603875\n    css += '\\n/*# sourceMappingURL=data:application/json;base64,' + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + ' */'\n  }\n\n  if (styleElement.styleSheet) {\n    styleElement.styleSheet.cssText = css\n  } else {\n    while (styleElement.firstChild) {\n      styleElement.removeChild(styleElement.firstChild)\n    }\n    styleElement.appendChild(document.createTextNode(css))\n  }\n}\n"],"names":["Mixin","Filter","Shopware","template","mixins","getByName","inject","props","order","type","Object","required","transaction","data","isLoading","hasError","showRefundModal","isRefundSuccessful","refundAmount","includeShippingCosts","items","computed","currencyFilter","payoneCurrencyFilter","decimalPrecision","currency","itemRounding","decimals","remainingAmount","extensions","payonePaymentOrderTransactionData","capturedAmount","refundedAmount","maxRefundAmount","buttonEnabled","allowRefund","selectedItems","filter","item","selected","quantity","hasRemainingRefundableShippingCosts","shippingCosts","totalPrice","refundedPositionAmount","lineItems","forEach","order_item","customFields","payone_refunded_quantity","unitPrice","Math","round","methods","calculateActionAmount","amount","selection","unit_price","openRefundModal","initItems","map","qty","getRefundableQuantityOfItem","orderItem","id","maxQuantity","product","label","disabled","push","$tc","closeRefundModal","onRefundFinished","refundOrder","request","orderTransactionId","payone_order_id","transactionId","salesChannel","orderLines","complete","orderLineItem","find","lineItem","copy","taxRate","tax_rate","total_amount","total_tax_amount","executeRefund","payone_captured_quantity","refundFullOrder","PayonePaymentService","refundPayment","then","createNotificationSuccess","title","message","catch","createNotificationError","error","finally","$nextTick","$emit","watch","handler","deep","content","__esModule","default","module","locals","exports","add","listToStyles","parentId","list","styles","newStyles","i","length","part","css","media","sourceMap","parts","hasDocument","document","DEBUG","stylesInDom","head","getElementsByTagName","singletonElement","singletonCounter","isProduction","noop","options","ssrIdKey","isOldIE","navigator","test","userAgent","toLowerCase","addStylesClient","_isProduction","_options","addStylesToDom","newList","mayRemove","domStyle","refs","j","addStyle","createStyleElement","styleElement","createElement","appendChild","obj","update","remove","querySelector","parentNode","removeChild","styleIndex","applyToSingletonTag","bind","applyToTag","newObj","replaceText","textStore","index","replacement","Boolean","join","styleSheet","cssText","cssNode","createTextNode","childNodes","insertBefore","setAttribute","ssrId","sources","btoa","unescape","encodeURIComponent","JSON","stringify","firstChild"],"sourceRoot":""}