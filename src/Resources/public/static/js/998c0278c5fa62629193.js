"use strict";(window["webpackJsonpPluginpayone-payment"]=window["webpackJsonpPluginpayone-payment"]||[]).push([[287],{287:function(e,t,o){o.r(t),o.d(t,{default:function(){return a}});let{Criteria:n}=Shopware.Data,{Filter:r}=Shopware;var a={template:'{% block payone_payment_order_action_log %}\n    <sw-card\n            class="payone-payment-order-action-log-card"\n            position-identifier="payone-payment-order-action-log-card"\n            :title="$tc(\'sw-order.payone-payment.orderActionLog.cardTitle\')"\n    >\n        <sw-data-grid\n                v-if="orderActionLogs.length > 0"\n                :showSelection="false"\n                :dataSource="orderActionLogs"\n                :columns="orderActionLogColumns"\n                :isLoading="isLoading"\n        >\n            <template #column-amount="{ item }">\n                {{ currencyFilter(item.amount / 100, order.currency.isoCode) }}\n            </template>\n\n            <template #column-requestDateTime="{ item }">\n                {{ dateFilter(item.requestDateTime, { hour: \'2-digit\', minute: \'2-digit\' }) }}\n            </template>\n\n            <template #actions="{ item }">\n                <sw-context-menu-item @click="openRequest(item)">\n                    {{ $tc(\'sw-order.payone-payment.orderActionLog.contextMenu.openRequestDetails\') }}\n                </sw-context-menu-item>\n                <sw-context-menu-item @click="openResponse(item)">\n                    {{ $tc(\'sw-order.payone-payment.orderActionLog.contextMenu.openResponseDetails\') }}\n                </sw-context-menu-item>\n            </template>\n\n            <template #action-modals="{ item }">\n                <sw-modal\n                        v-if="showRequestDetails"\n                        :title="$tc(\'sw-order.payone-payment.orderActionLog.requestDetailsModal.title\')"\n                        variant="large"\n                        @modal-close="onCloseRequestModal"\n                >\n                    <sw-button variant="primary" @click="downloadAsTxt(showRequestDetails, \'request\', item.transactionId)">\n                        {{ $tc(\'sw-order.payone-payment.orderActionLog.requestDetailsModal.downloadButton\') }}\n                    </sw-button>\n                    <sw-data-grid\n                            :showSelection="false"\n                            :showActions="false"\n                            :dataSource="toKeyValueSource(showRequestDetails)"\n                            :columns="keyValueColumns"\n                            :isLoading="isLoading"\n                    >\n                    </sw-data-grid>\n                </sw-modal>\n                <sw-modal\n                        v-if="showResponseDetails"\n                        :title="$tc(\'sw-order.payone-payment.orderActionLog.responseDetailsModal.title\')"\n                        variant="large"\n                        @modal-close="onCloseResponseModal"\n                >\n                    <sw-button variant="primary" @click="downloadAsTxt(showResponseDetails, \'response\', item.transactionId)">\n                        {{ $tc(\'sw-order.payone-payment.orderActionLog.responseDetailsModal.downloadButton\') }}\n                    </sw-button>\n                    <sw-data-grid\n                            :showSelection="false"\n                            :showActions="false"\n                            :dataSource="toKeyValueSource(showResponseDetails)"\n                            :columns="keyValueColumns"\n                            :isLoading="isLoading"\n                    >\n                    </sw-data-grid>\n                </sw-modal>\n            </template>\n        </sw-data-grid>\n\n        <sw-empty-state\n                v-else\n                :absolute="false"\n                :title="$tc(\'sw-order.payone-payment.orderActionLog.emptyState.title\')"\n                :subline="$tc(\'sw-order.payone-payment.orderActionLog.emptyState.subline\')"\n        >\n            <template #icon>\n                <img\n                        :src="assetFilter(\'/administration/static/img/empty-states/order-empty-state.svg\')"\n                        :alt="$tc(\'sw-order.payone-payment.orderActionLog.emptyState.title\')"\n                >\n            </template>\n        </sw-empty-state>\n    </sw-card>\n{% endblock %}\n',inject:["repositoryFactory"],props:{order:{type:Object,required:!0}},data(){return{orderActionLogs:[],isLoading:!1,showRequestDetails:null,showResponseDetails:null}},computed:{orderActionLogRepository(){return this.repositoryFactory.create("payone_payment_order_action_log")},dateFilter(){return r.getByName("date")},currencyFilter(){return r.getByName("currency")},assetFilter(){return r.getByName("asset")},payoneCurrencyFilter(){return r.getByName("payone_currency")},orderActionLogColumns(){return[{property:"transactionId",label:this.$tc("sw-order.payone-payment.orderActionLog.columnTitleTransactionId")},{property:"request",label:this.$tc("sw-order.payone-payment.orderActionLog.columnTitleRequest")},{property:"response",label:this.$tc("sw-order.payone-payment.orderActionLog.columnTitleResponse")},{property:"amount",label:this.$tc("sw-order.payone-payment.orderActionLog.columnTitleAmount")},{property:"requestDateTime",label:this.$tc("sw-order.payone-payment.orderActionLog.columnTitleRequestDateTime")}]},keyValueColumns(){return[{property:"key",label:this.$tc("sw-order.payone-payment.orderActionLog.columnTitleKey")},{property:"value",label:this.$tc("sw-order.payone-payment.orderActionLog.columnTitleValue")}]}},created(){this.createdComponent()},methods:{createdComponent(){this.getOrderActionLogs()},reloadActionLogs(){this.getOrderActionLogs()},getOrderActionLogs(){let e=new n;return e.addFilter(n.equals("orderId",this.order.id)),e.addSorting(n.sort("requestDateTime","ASC",!0)),this.isLoading=!0,this.orderActionLogRepository.search(e,Shopware.Context.api).then(e=>{this.orderActionLogs=e,this.isLoading=!1})},openRequest(e){this.showRequestDetails=e.requestDetails},openResponse(e){this.showResponseDetails=e.responseDetails},onCloseRequestModal(){this.showRequestDetails=null},onCloseResponseModal(){this.showResponseDetails=null},toKeyValueSource(e){let t=[];for(let o in e)t.push({key:o,value:e[o]});return t.sort((e,t)=>e.key.localeCompare(t.key)),t},downloadAsTxt(e,t,o){let n=document.createElement("a");n.href="data:text/plain;charset=utf-8,"+encodeURIComponent(JSON.stringify(e,null,4)),n.download=`PAYONE-${t}-${o}.txt`,n.dispatchEvent(new MouseEvent("click")),n.remove()}}}}}]);