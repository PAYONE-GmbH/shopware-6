(()=>{"use strict";var e={857:e=>{var t=function(e){var t;return!!e&&"object"==typeof e&&"[object RegExp]"!==(t=Object.prototype.toString.call(e))&&"[object Date]"!==t&&e.$$typeof!==n},n="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function r(e,t){return!1!==t.clone&&t.isMergeableObject(e)?s(Array.isArray(e)?[]:{},e,t):e}function i(e,t,n){return e.concat(t).map(function(e){return r(e,n)})}function a(e){return Object.keys(e).concat(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return Object.propertyIsEnumerable.call(e,t)}):[])}function o(e,t){try{return t in e}catch(e){return!1}}function s(e,n,l){(l=l||{}).arrayMerge=l.arrayMerge||i,l.isMergeableObject=l.isMergeableObject||t,l.cloneUnlessOtherwiseSpecified=r;var d,c,u=Array.isArray(n);return u!==Array.isArray(e)?r(n,l):u?l.arrayMerge(e,n,l):(c={},(d=l).isMergeableObject(e)&&a(e).forEach(function(t){c[t]=r(e[t],d)}),a(n).forEach(function(t){(!o(e,t)||Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))&&(o(e,t)&&d.isMergeableObject(n[t])?c[t]=(function(e,t){if(!t.customMerge)return s;var n=t.customMerge(e);return"function"==typeof n?n:s})(t,d)(e[t],n[t],d):c[t]=r(n[t],d))}),c)}s.all=function(e,t){if(!Array.isArray(e))throw Error("first argument should be an array");return e.reduce(function(e,n){return s(e,n,t)},{})},e.exports=s}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}(()=>{n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t}})(),(()=>{n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}})(),(()=>{n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e=n(857),t=n.n(e);class r{static ucFirst(e){return e.charAt(0).toUpperCase()+e.slice(1)}static lcFirst(e){return e.charAt(0).toLowerCase()+e.slice(1)}static toDashCase(e){return e.replace(/([A-Z])/g,"-$1").replace(/^-/,"").toLowerCase()}static toLowerCamelCase(e,t){let n=r.toUpperCamelCase(e,t);return r.lcFirst(n)}static toUpperCamelCase(e,t){return t?e.split(t).map(e=>r.ucFirst(e.toLowerCase())).join(""):r.ucFirst(e.toLowerCase())}static parsePrimitive(e){try{return/^\d+(.|,)\d+$/.test(e)&&(e=e.replace(",",".")),JSON.parse(e)}catch(t){return e.toString()}}}class i{static isNode(e){return"object"==typeof e&&null!==e&&(e===document||e===window||e instanceof Node)}static hasAttribute(e,t){if(!i.isNode(e))throw Error("The element must be a valid HTML Node!");return"function"==typeof e.hasAttribute&&e.hasAttribute(t)}static getAttribute(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(n&&!1===i.hasAttribute(e,t))throw Error('The required property "'.concat(t,'" does not exist!'));if("function"!=typeof e.getAttribute){if(n)throw Error("This node doesn't support the getAttribute function!");return}return e.getAttribute(t)}static getDataAttribute(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],a=t.replace(/^data(|-)/,""),o=r.toLowerCamelCase(a,"-");if(!i.isNode(e)){if(n)throw Error("The passed node is not a valid HTML Node!");return}if(void 0===e.dataset){if(n)throw Error("This node doesn't support the dataset attribute!");return}let s=e.dataset[o];if(void 0===s){if(n)throw Error('The required data attribute "'.concat(t,'" does not exist on ').concat(e,"!"));return s}return r.parsePrimitive(s)}static querySelector(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(n&&!i.isNode(e))throw Error("The parent node is not a valid HTML Node!");let r=e.querySelector(t)||!1;if(n&&!1===r)throw Error('The required element "'.concat(t,'" does not exist in parent node!'));return r}static querySelectorAll(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(n&&!i.isNode(e))throw Error("The parent node is not a valid HTML Node!");let r=e.querySelectorAll(t);if(0===r.length&&(r=!1),n&&!1===r)throw Error('At least one item of "'.concat(t,'" must exist in parent node!'));return r}static getFocusableElements(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body;return e.querySelectorAll('\n            input:not([tabindex^="-"]):not([disabled]):not([type="hidden"]),\n            select:not([tabindex^="-"]):not([disabled]),\n            textarea:not([tabindex^="-"]):not([disabled]),\n            button:not([tabindex^="-"]):not([disabled]),\n            a[href]:not([tabindex^="-"]):not([disabled]),\n            [tabindex]:not([tabindex^="-"]):not([disabled])\n        ')}static getFirstFocusableElement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body;return this.getFocusableElements(e)[0]}static getLastFocusableElement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=this.getFocusableElements(e);return t[t.length-1]}}class a{publish(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=new CustomEvent(e,{detail:t,cancelable:n});return this.el.dispatchEvent(r),r}subscribe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this,i=e.split("."),a=n.scope?t.bind(n.scope):t;if(n.once&&!0===n.once){let t=a;a=function(n){r.unsubscribe(e),t(n)}}return this.el.addEventListener(i[0],a),this.listeners.push({splitEventName:i,opts:n,cb:a}),!0}unsubscribe(e){let t=e.split(".");return this.listeners=this.listeners.reduce((e,n)=>([...n.splitEventName].sort().toString()===t.sort().toString()?this.el.removeEventListener(n.splitEventName[0],n.cb):e.push(n),e),[]),!0}reset(){return this.listeners.forEach(e=>{this.el.removeEventListener(e.splitEventName[0],e.cb)}),this.listeners=[],!0}get el(){return this._el}set el(e){this._el=e}get listeners(){return this._listeners}set listeners(e){this._listeners=e}constructor(e=document){this._el=e,e.$emitter=this,this._listeners=[]}}class o{init(){throw Error('The "init" method for the plugin "'.concat(this._pluginName,'" is not defined.'))}update(){}_init(){this._initialized||(this.init(),this._initialized=!0)}_update(){this._initialized&&this.update()}_mergeOptions(e){let n=r.toDashCase(this._pluginName),a=i.getDataAttribute(this.el,"data-".concat(n,"-config"),!1),o=i.getAttribute(this.el,"data-".concat(n,"-options"),!1),s=[this.constructor.options,this.options,e];a&&s.push(window.PluginConfigManager.get(this._pluginName,a));try{o&&s.push(JSON.parse(o))}catch(e){throw console.error(this.el),Error('The data attribute "data-'.concat(n,'-options" could not be parsed to json: ').concat(e.message))}return t().all(s.filter(e=>e instanceof Object&&!(e instanceof Array)).map(e=>e||{}))}_registerInstance(){window.PluginManager.getPluginInstancesFromElement(this.el).set(this._pluginName,this),window.PluginManager.getPlugin(this._pluginName,!1).get("instances").push(this)}_getPluginName(e){return e||(e=this.constructor.name),e}constructor(e,t={},n=!1){if(!i.isNode(e))throw Error("There is no valid element given.");this.el=e,this.$emitter=new a(this.el),this._pluginName=this._getPluginName(n),this.options=this._mergeOptions(t),this._initialized=!1,this._registerInstance(),this._init()}}class s{static iterate(e,t){if(e instanceof Map||Array.isArray(e))return e.forEach(t);if(e instanceof FormData){for(var n of e.entries())t(n[1],n[0]);return}if(e instanceof NodeList)return e.forEach(t);if(e instanceof HTMLCollection)return Array.from(e).forEach(t);if(e instanceof Object)return Object.keys(e).forEach(n=>{t(e[n],n)});throw Error("The element type ".concat(typeof e," is not iterable!"))}}let l="loader",d={BEFORE:"before",INNER:"inner"};class c{create(){if(!this.exists()){if(this.position===d.INNER){this.parent.innerHTML=c.getTemplate();return}this.parent.insertAdjacentHTML(this._getPosition(),c.getTemplate())}}remove(){let e=this.parent.querySelectorAll(".".concat(l));s.iterate(e,e=>e.remove())}exists(){return this.parent.querySelectorAll(".".concat(l)).length>0}_getPosition(){return this.position===d.BEFORE?"afterbegin":"beforeend"}static getTemplate(){return'<div class="'.concat(l,'" role="status">\n                    <span class="').concat("visually-hidden",'">Loading...</span>\n                </div>')}static SELECTOR_CLASS(){return l}constructor(e,t=d.BEFORE){this.parent=e instanceof Element?e:document.body.querySelector(e),this.position=t}}class u extends c{create(){super.create(),this._isButtonElement()?this.parent.disabled=!0:this._isAnchorElement()&&this.parent.classList.add("disabled")}remove(){super.remove(),this._isButtonElement()?this.parent.disabled=!1:this._isAnchorElement()&&this.parent.classList.remove("disabled")}_isButtonElement(){return"button"===this.parent.tagName.toLowerCase()}_isAnchorElement(){return"a"===this.parent.tagName.toLowerCase()}constructor(e,t="before"){if(super(e,t),!this._isButtonElement()&&!this._isAnchorElement())throw Error("Parent element is not of type <button> or <a>")}}class h extends o{init(){this.iframe=null,this.iframeFieldCheckerStarted=!1,this.orderFormDisabled=!0;let e=document.getElementById("payone-request"),t=e.getAttribute("data-payone-language"),n=JSON.parse(e.innerHTML);this._createScript(()=>{let e=this.getClientConfig(t);this.iframe=new window.Payone.ClientApi.HostedIFrames(e,n);let r=document.getElementById("savedpseudocardpan"),i=document.getElementById("confirmOrderForm");r&&r.addEventListener("change",this._handleChangeSavedCard.bind(this)),i&&i.addEventListener("submit",this._handleOrderSubmit.bind(this))})}getSelectStyle(){return["width: 100%","padding: .5625rem","color: #8798a9","vertical-align: middle","line-height: 1.5","font-weight: 500","background-color: #fff","border: none","border-radius: 3px"]}getFieldStyle(){return["width: 100%","height: 100%","padding: .5625rem","color: #8798a9","vertical-align: middle","line-height: 1.5","font-weight: 500","background-color: #fff","border: none","border-radius: .1875rem"]}getClientConfig(e){return{fields:{cardpan:{selector:"cardpan",type:"text",style:this.getFieldStyle().join("; ")},cardcvc2:{selector:"cardcvc2",type:"password",size:"4",maxlength:"4",length:{V:3,M:3,A:4,D:3,J:0,O:3,P:3,U:3},style:this.getFieldStyle().join("; ")},cardexpiremonth:{selector:"cardexpiremonth",type:"select",size:"2",maxlength:"2",style:this.getSelectStyle().join("; ")},cardexpireyear:{selector:"cardexpireyear",type:"select",style:this.getSelectStyle().join("; ")}},language:window.Payone.ClientApi.Language[e],defaultStyle:{iframe:{height:"100%",width:"100%"}},autoCardtypeDetection:{supportedCardtypes:h.options.supportedCardtypes,callback:this._cardDetectionCallback}}}_cardDetectionCallback(e){if("-"===e||"?"===e)return;let t="https://cdn.pay1.de/cc/"+e.toLowerCase()+"/xl/default.png",n=document.getElementById("errorOutput"),r=document.getElementById("card-logo");r.setAttribute("src",t),n.style.display="none",r.style.display="block"}_createScript(e){let t=document.createElement("script");t.type="text/javascript",t.src="https://secure.pay1.de/client-api/js/v1/payone_hosted.js",t.addEventListener("load",e.bind(this),!1),document.head.appendChild(t)}_handleOrderSubmit(e){document.getElementById("errorOutput").style.display="none";let t=document.getElementById("savedpseudocardpan");if(t&&t.value.length>0)return!0;if(!this.iframe.isComplete()){let t=document.getElementById("iframeErrorOutput");return this.iframeFieldCheckerStarted||setInterval(()=>{this.iframe.isComplete()?t.style.display="none":t.style.display="block"},250),this.iframeFieldCheckerStarted=!0,this._handleOrderFormError(e),!1}if(this.orderFormDisabled)return window.payoneCreditCardCheckCallback=this._payoneCheckCallback.bind(this),this.iframe.creditCardCheck("payoneCreditCardCheckCallback"),this._handleOrderFormError(e),!1}_handleOrderFormError(e){let t=document.getElementById("confirmFormSubmit");if(e.preventDefault(),t){let e=new u(t);t.disabled=!1,e.remove()}}_handleChangeSavedCard(){let e=document.getElementById("savedpseudocardpan"),t=e.options[e.selectedIndex];if(t.value){var n;[...document.getElementsByClassName("credit-card-input")].forEach(function(e){e.classList.add("hide")}),((n=t.dataset.cardHolder)===null||void 0===n?void 0:n.length)?document.getElementById("creditCardHolder").value=t.dataset.cardHolder:document.getElementById("card-holder-input-wrapper").classList.remove("hide")}else[...document.getElementsByClassName("credit-card-input")].forEach(function(e){e.classList.remove("hide")})}_payoneCheckCallback(e){if("VALID"===e.status)document.getElementById("pseudocardpan").value=e.pseudocardpan,document.getElementById("truncatedcardpan").value=e.truncatedcardpan,document.getElementById("cardexpiredate").value=e.cardexpiredate,document.getElementById("cardtype").value=e.cardtype,this.orderFormDisabled=!1,document.getElementById("confirmOrderForm").submit();else{let t=document.getElementById("confirmFormSubmit"),n=document.getElementById("errorOutput");t.removeAttribute("disabled"),n.innerHTML=e.errormessage,n.style.display="block"}}}h.options={supportedCardtypes:["#","V","A","M","D","J","O","U","P"]};class m{static isTouchDevice(){return"ontouchstart"in document.documentElement}static isIOSDevice(){return m.isIPhoneDevice()||m.isIPadDevice()}static isNativeWindowsBrowser(){return m.isIEBrowser()||m.isEdgeBrowser()}static isIPhoneDevice(){return!!navigator.userAgent.match(/iPhone/i)}static isIPadDevice(){return!!navigator.userAgent.match(/iPad/i)}static isIEBrowser(){return -1!==navigator.userAgent.toLowerCase().indexOf("msie")||!!navigator.userAgent.match(/Trident.*rv:\d+\./)}static isEdgeBrowser(){return!!navigator.userAgent.match(/Edge\/\d+/i)}static getList(){return{"is-touch":m.isTouchDevice(),"is-ios":m.isIOSDevice(),"is-native-windows":m.isNativeWindowsBrowser(),"is-iphone":m.isIPhoneDevice(),"is-ipad":m.isIPadDevice(),"is-ie":m.isIEBrowser(),"is-edge":m.isEdgeBrowser()}}}let p="modal-backdrop",y="modal-backdrop-open",g="no-scroll",b={ON_CLICK:"backdrop/onclick"};class _{create(e){this._removeExistingBackdrops(),document.body.insertAdjacentHTML("beforeend",this._getTemplate());let t=document.body.lastChild;document.documentElement.classList.add(g),setTimeout(function(){t.classList.add(y),"function"==typeof e&&e()},75),this._dispatchEvents()}remove(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:350,t=this._getBackdrops();s.iterate(t,e=>e.classList.remove(y)),setTimeout(this._removeExistingBackdrops.bind(this),e),document.documentElement.classList.remove(g)}_dispatchEvents(){let e=m.isTouchDevice()?"touchstart":"click";document.addEventListener(e,function(e){e.target.classList.contains(p)&&document.dispatchEvent(new CustomEvent(b.ON_CLICK))})}_getBackdrops(){return document.querySelectorAll(".".concat(p))}_removeExistingBackdrops(){if(!1===this._exists())return;let e=this._getBackdrops();s.iterate(e,e=>e.remove())}_exists(){return document.querySelectorAll(".".concat(p)).length>0}_getTemplate(){return'<div class="'.concat(p,'"></div>')}constructor(){return _.instance||(_.instance=this),_.instance}}let v=Object.freeze(new _);class E{static create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;v.create(e)}static remove(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:350;v.remove(e)}static SELECTOR_CLASS(){return p}}let f="js-pseudo-modal";class I{open(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:350;this._hideExistingModal(),this._create(),setTimeout(this._open.bind(this,e),t)}close(){let e=this.getModal();this._modalInstance=bootstrap.Modal.getInstance(e),this._modalInstance.hide()}getModal(){return this._modal||this._create(),this._modal}updatePosition(){this._modalInstance.handleUpdate()}updateContent(e,t){this._content=e,this._setModalContent(e),this.updatePosition(),"function"==typeof t&&t.bind(this)()}_hideExistingModal(){try{let e=i.querySelector(document,".".concat(f," .modal"),!1);if(!e)return;let t=bootstrap.Modal.getInstance(e);if(!t)return;t.hide()}catch(e){console.warn("[PseudoModalUtil] Unable to hide existing pseudo modal before opening pseudo modal: ".concat(e.message))}}_open(e){this.getModal(),this._modal.addEventListener("hidden.bs.modal",this._modalWrapper.remove),this._modal.addEventListener("shown.bs.modal",e),this._modalInstance.show()}_create(){this._modalMarkupEl=i.querySelector(document,this._templateSelector),this._createModalWrapper(),this._modalWrapper.innerHTML=this._content,this._modal=this._createModalMarkup(),this._modalInstance=new bootstrap.Modal(this._modal,{backdrop:this._useBackdrop}),document.body.insertAdjacentElement("beforeend",this._modalWrapper)}_createModalWrapper(){this._modalWrapper=i.querySelector(document,".".concat(f),!1),this._modalWrapper||(this._modalWrapper=document.createElement("div"),this._modalWrapper.classList.add(f))}_createModalMarkup(){let e=i.querySelector(this._modalWrapper,".modal",!1);if(e)return e;let t=this._modalWrapper.innerHTML;return this._modalWrapper.innerHTML=this._modalMarkupEl.innerHTML,this._setModalContent(t),i.querySelector(this._modalWrapper,".modal")}_setModalTitle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{i.querySelector(this._modalWrapper,this._templateTitleSelector).innerHTML=e}catch(e){}}_setModalContent(e){let t=i.querySelector(this._modalWrapper,this._templateContentSelector);t.innerHTML=e;try{let e=i.querySelector(t,this._templateTitleSelector);e&&(this._setModalTitle(e.innerHTML),e.parentNode.removeChild(e))}catch(e){}}constructor(e,t=!0,n=".".concat("js-pseudo-modal-template"),r=".".concat("js-pseudo-modal-template-content-element"),i=".".concat("js-pseudo-modal-template-title-element")){this._content=e,this._useBackdrop=t,this._templateSelector=n,this._templateContentSelector=r,this._templateTitleSelector=i}}let S=Object.freeze(new class extends c{create(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];!this.exists()&&e&&(E.create(),document.querySelector(".".concat(E.SELECTOR_CLASS())).insertAdjacentHTML("beforeend",c.getTemplate()))}remove(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];super.remove(),e&&E.remove()}constructor(){super(document.body)}});class C{static create(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];S.create(e)}static remove(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];S.remove(e)}}class w{get(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"application/json",r=this._createPreparedRequest("GET",e,n);return this._sendRequest(r,null,t)}post(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"application/json";r=this._getContentType(t,r);let i=this._createPreparedRequest("POST",e,r);return this._sendRequest(i,t,n)}delete(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"application/json";r=this._getContentType(t,r);let i=this._createPreparedRequest("DELETE",e,r);return this._sendRequest(i,t,n)}patch(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"application/json";r=this._getContentType(t,r);let i=this._createPreparedRequest("PATCH",e,r);return this._sendRequest(i,t,n)}abort(){if(this._request)return this._request.abort()}setErrorHandlingInternal(e){this._errorHandlingInternal=e}_registerOnLoaded(e,t){t&&(!0===this._errorHandlingInternal?(e.addEventListener("load",()=>{t(e.responseText,e)}),e.addEventListener("abort",()=>{console.warn("the request to ".concat(e.responseURL," was aborted"))}),e.addEventListener("error",()=>{console.warn("the request to ".concat(e.responseURL," failed with status ").concat(e.status))}),e.addEventListener("timeout",()=>{console.warn("the request to ".concat(e.responseURL," timed out"))})):e.addEventListener("loadend",()=>{t(e.responseText,e)}))}_sendRequest(e,t,n){return this._registerOnLoaded(e,n),e.send(t),e}_getContentType(e,t){return e instanceof FormData&&(t=!1),t}_createPreparedRequest(e,t,n){return this._request=new XMLHttpRequest,this._request.open(e,t),this._request.setRequestHeader("X-Requested-With","XMLHttpRequest"),n&&this._request.setRequestHeader("Content-type",n),this._request}constructor(){this._request=null,this._errorHandlingInternal=!1}}class L extends o{init(){this.orderFormDisabled=!0,this._client=new w,document.getElementById("confirmOrderForm").addEventListener("submit",this._handleOrderSubmit.bind(this))}_handleOrderSubmit(e){document.getElementById("errorOutput").style.display="none",this.orderFormDisabled&&(this._handleOrderFormError(e),this._getModal(e))}_handleOrderFormError(e){let t=document.getElementById("confirmFormSubmit");if(e.preventDefault(),t){let e=new u(t);t.disabled=!1,e.remove()}}_getModal(e){e.preventDefault(),C.create();let t=this._getRequestData();this._client.abort(),this._client.post(this._getManageMandateUrl(),JSON.stringify(t),e=>this._openModal(e))}_submitForm(){this.orderFormDisabled=!1,document.getElementById("confirmOrderForm").submit()}_openModal(e){if((e=JSON.parse(e)).error){let t=document.getElementById("errorOutput");t.innerHTML=e.error,t.style.display="block",C.remove();return}if("active"===e.mandate.Status){this._submitForm();return}let t=new I(e.modal_content);t.open(this._onOpen.bind(this,t))}_onOpen(e){e.getModal().classList.add("payone-debit-mandate-modal"),window.PluginManager.initializePlugins(),this._registerEvents(),C.remove()}_getRequestData(){return{iban:document.getElementById("iban").value}}_getManageMandateUrl(){return document.getElementById("payone-configuration").getAttribute("data-manage-mandate-url")}_registerEvents(){document.getElementById("mandateSubmit").addEventListener("click",this._onMandateSubmit.bind(this))}_onMandateSubmit(){document.getElementById("accept-mandate").checked&&this._submitForm()}}L.options={editorModalClass:"payone-debit-modal"};class B extends o{init(){null===this.options.supportedNetworks&&(this.options.supportedNetworks=[]),this._httpClient=new w,this.validateMerchantUrl=this.el.dataset.validateMerchantUrl,this.processPaymentUrl=this.el.dataset.processPaymentUrl,this.orderForm=i.querySelector(document,"#confirmOrderForm"),this._registerEventHandler()}createSession(){try{this.session=new ApplePaySession(3,this.options)}catch(e){this.handleErrorOnPayment();return}this.session.addEventListener("validatemerchant",this.validateMerchant.bind(this)),this.session.addEventListener("paymentauthorized",this.authorizePayment.bind(this))}performPayment(){this.session.begin()}validateMerchant(e){let t=e.validationURL;this._httpClient.abort(),this._httpClient.post(this.validateMerchantUrl,JSON.stringify({validationUrl:t}),e=>{let t=null;try{t=JSON.parse(e)}catch(e){this.handleErrorOnPayment();return}if(!t||!t.merchantSessionIdentifier||!t.signature){this.handleErrorOnPayment();return}this.session.completeMerchantValidation(t)})}handleErrorOnPayment(){let e=i.querySelector(document,"#payone-apple-pay-error");e.style.display="block",e.scrollIntoView({block:"start"})}authorizePayment(e){let t=i.querySelector(this.orderForm,"input[name='orderId']").value;this._httpClient.abort(),this._httpClient.post(this.processPaymentUrl,JSON.stringify({token:e.payment.token,orderId:t}),e=>{this.completePayment(e),this.orderForm.submit()})}completePayment(e){let t="",n="",r="";try{let i=JSON.parse(e);n=i.status,t=i.txid,r=i.userid}catch(e){this.orderForm.submit()}this.updateFormData(n,t,r,e),("APPROVED"===n||"PENDING"===n)&&this.session.completePayment({status:ApplePaySession.STATUS_SUCCESS,errors:[]}),this.orderForm.submit()}updateFormData(e,t,n,r){i.querySelector(this.orderForm,"input[name='status']").value=e,i.querySelector(this.orderForm,"input[name='txid']").value=t,i.querySelector(this.orderForm,"input[name='userid']").value=n,i.querySelector(this.orderForm,"input[name='response']").value=r}_handleApplePayButtonClick(){this.orderForm.reportValidity()&&(this.createSession(),this.performPayment())}_registerEventHandler(){this.el.addEventListener("click",this._handleApplePayButtonClick.bind(this))}}B.options={countryCode:"",currencyCode:"",supportedNetworks:[],merchantCapabilities:["supports3DS","supportsDebit","supportsCredit"],total:{label:"",type:"final",amount:"0.01"}};class O extends o{init(){this._client=new w,this.ratepayRateInput=i.querySelector(document,this.options.ratepayRateInputSelector),this.calculateInstallmentBtn=i.querySelector(document,this.options.calculateInstallmentBtnSelector),this.ratepayRuntimeInput=i.querySelector(document,this.options.ratepayRuntimeInputSelector),this.ratepayIbanContainer=i.querySelector(document,this.options.ratepayIbanContainerSelector),this.ratepayIbanInput=i.querySelector(document,this.options.ratepayIbanInputSelector),this._registerEventListeners(),this._handleInstallmentRuntimeChange()}_registerEventListeners(){this.calculateInstallmentBtn&&this.calculateInstallmentBtn.addEventListener("click",this._handleCalculateInstallmentButtonClick.bind(this)),this.ratepayRuntimeInput&&this.ratepayRuntimeInput.addEventListener("change",this._handleInstallmentRuntimeChange.bind(this)),document.querySelector(this.options.ratepayIbanContainerSelector).addEventListener("shown.bs.collapse",()=>this.ratepayIbanInput.required=!0),document.querySelector(this.options.ratepayIbanContainerSelector).addEventListener("hidden.bs.collapse",()=>this.ratepayIbanInput.required=!1)}_handleCalculateInstallmentButtonClick(){let e=this.ratepayRateInput.value;this._sendRequest("rate",e)}_handleInstallmentRuntimeChange(){let e=i.querySelector(document,this.options.ratepayRuntimeInputSelector).value;this._sendRequest("time",e)}_sendRequest(e,t){let n=JSON.stringify({ratepayInstallmentType:e,ratepayInstallmentValue:t});this._client.abort(),this._client.post("/payone/ratepay/installment/calculation",n,e=>this._handleCalculationCallback(e))}_handleCalculationCallback(e){this._replaceCalculationContent(e)}_replaceCalculationContent(e){i.querySelector(document,this.options.ratepayInstallmentPlanContainerSelector).innerHTML=e,this.ratepayInstallmentTable=i.querySelector(document,this.options.ratepayInstallmentTableSelector),this.ratepayRuntimeInput.value=this.ratepayInstallmentTable.dataset.ratepayNumberOfRates,this.ratepayRateInput.value=this.ratepayInstallmentTable.dataset.ratepayRate}}O.options={ratepayRateInputSelector:"#ratepayRate",ratepayRuntimeInputSelector:"#ratepayRuntime",calculateInstallmentBtnSelector:"#payone-ratepay-calculate-installment-btn",ratepayInstallmentPlanContainerSelector:"#payone-ratepay-installment-plan",ratepayIbanContainerSelector:"#ratepayIbanContainer",ratepayIbanInputSelector:"#ratepayIban",ratepayInstallmentTableSelector:"#ratepayInstallmentTable"};class P extends o{init(){window.klarnaAsyncCallback=this._initKlarnaWidget.bind(this);let e=document.createElement("script");e.src="https://x.klarnacdn.net/kp/lib/v1/api.js",document.body.appendChild(e),this.orderForm=document.getElementById(this.options.selectorFormId),this.confirmFormSubmit=this.orderForm.querySelector("button[type=submit]"),this._registerEventListeners()}_initKlarnaWidget(){Klarna.Payments.init({client_token:this.options.clientToken}),Klarna.Payments.load({container:this.options.selectorContainer,payment_method_category:this.options.paymentMethodIdentifier},e=>{new u(this.confirmFormSubmit).remove()})}_registerEventListeners(){this.orderForm&&this.orderForm.addEventListener("submit",this._handleOrderSubmit.bind(this))}_handleOrderSubmit(e){e.preventDefault(),Klarna.Payments.authorize({payment_method_category:this.options.paymentMethodIdentifier},{},e=>{e.approved&&e.authorization_token?(document.querySelector(this.options.selectorTokenInput).value=e.authorization_token,this.orderForm.submit()):e.show_form?new u(this.confirmFormSubmit).remove():e.show_form||(window.location.href=window.location.href)})}}P.options={clientToken:null,paymentMethodIdentifier:null,selectorContainer:null,selectorTokenInput:'input[name="payoneKlarnaAuthorizationToken"]',selectorFormId:"confirmOrderForm"},P.orderForm=null,P.confirmFormSubmit=null;class k extends o{init(){if(!this.options.clientId||!this.options.merchantId||!this.options.currency||!this.options.locale||!this.options.createCheckoutSessionUrl||!this.options.onApproveRedirectUrl||!this.options.onCancelRedirectUrl||!this.options.onErrorRedirectUrl){console.error("The PayPal v2 Express button could not be initialized because the required options are missing.");return}this._client=new w,this._loadScript()}_loadScript(){let e=new URLSearchParams({"client-id":this.options.clientId,"merchant-id":this.options.merchantId,currency:this.options.currency,intent:"authorize",locale:this.options.locale,commit:"false",vault:"false","disable-funding":"card,sepa,bancontact",...this.options.showPayLaterButton?{"enable-funding":"paylater"}:{}}).toString(),t=document.createElement("script");t.onload=()=>this._renderButtons(),this.options.sandbox?t.src="https://sandbox.paypal.com/sdk/js?".concat(e):t.src="https://www.paypal.com/sdk/js?".concat(e),document.head.append(t)}_renderButtons(){paypal.Buttons({style:{layout:"vertical",color:"gold",shape:"rect",label:"checkout",height:40},createOrder:this._createOrder.bind(this),onApprove:this._onApprove.bind(this),onCancel:this._onCancel.bind(this),onError:this._onError.bind(this)}).render("#payone-payment-paypal-v2-button-container")}_createOrder(){return new Promise((e,t)=>{this._client.get(this.options.createCheckoutSessionUrl,(n,r)=>{r.status>=400&&t(n);try{let t=JSON.parse(n);e(t.orderId)}catch(e){t(e)}})})}_onApprove(){window.location.href=this.options.onApproveRedirectUrl}_onCancel(){window.location.href=this.options.onCancelRedirectUrl}_onError(){window.location.href=this.options.onErrorRedirectUrl}}k.options={sandbox:!0,clientId:null,merchantId:null,currency:null,locale:null,showPayLaterButton:!1,createCheckoutSessionUrl:null,onApproveRedirectUrl:null,onCancelRedirectUrl:null,onErrorRedirectUrl:null};class F extends o{init(){if("amazon"in window)this.onLoad();else{var e=document.createElement("script");e.type="text/javascript",e.src="https://static-eu.payments-amazon.com/checkout.js",e.onload=this.onLoad.bind(this),document.head.appendChild(e)}}onLoad(){}}class M extends F{onLoad(){window.amazon.Pay.renderButton("#"+this.el.id,this.options)}}let A="element-loader-backdrop";class q extends c{static create(e){e.classList.add("has-element-loader"),q.exists(e)||(q.appendLoader(e),setTimeout(()=>{let t=e.querySelector(".".concat(A));t&&t.classList.add("element-loader-backdrop-open")},1))}static remove(e){e.classList.remove("has-element-loader");let t=e.querySelector(".".concat(A));t&&t.remove()}static exists(e){return e.querySelectorAll(".".concat(A)).length>0}static getTemplate(){return'\n        <div class="'.concat(A,'">\n            <div class="loader" role="status">\n                <span class="').concat("visually-hidden",'">Loading...</span>\n            </div>\n        </div>\n        ')}static appendLoader(e){e.insertAdjacentHTML("beforeend",q.getTemplate())}}PluginManager.register("PayonePaymentAmazonPayExpressButton",M,"[data-payone-payment-amazon-pay-express-button]"),PluginManager.register("PayonePaymentAmazonPayRedirect",class extends M{init(){q.create(document.querySelector(".content-main")),super.init()}onLoad(){super.onLoad(),document.querySelector("#"+this.el.id).dispatchEvent(new CustomEvent("click"))}},"[data-payone-payment-amazon-pay-redirect]");let T=window.PluginManager;T.register("PayonePaymentCreditCard",h,"[data-is-payone-credit-card]"),T.register("PayonePaymentDebitCard",L,"[data-is-payone-debit-card]"),T.register("PayonePaymentPayolutionInvoicing",class extends o{init(){this.orderFormDisabled=!0,this._client=new w,this._registerEventListeners()}_registerEventListeners(){let e=document.getElementById("confirmOrderForm");e&&e.addEventListener("submit",this._handleOrderSubmit.bind(this))}_handleOrderSubmit(e){this._hideErrorBox(),this.orderFormDisabled&&(this._validateField(e,"payolutionConsent"),this._validateInput(e,"payoneBirthday"),e.defaultPrevented||(this._validatePaymentAcceptance(),e.preventDefault()))}_validateField(e,t){let n=document.getElementById(t);if(n.checked){n.classList.remove("is-invalid");return}n.scrollIntoView({block:"start",behavior:"smooth"}),n.classList.add("is-invalid"),e.preventDefault()}_validateInput(e,t){let n=document.getElementById(t);if(n.value){n.classList.remove("is-invalid");return}n.scrollIntoView({block:"start",behavior:"smooth"}),n.classList.add("is-invalid"),e.preventDefault()}_validatePaymentAcceptance(){let e=JSON.stringify(this._getRequestData());C.create(),this._client.abort(),this._client.post(this._getValidateUrl(),e,e=>this._handleValidateResponse(e))}_handleValidateResponse(e){if(e=JSON.parse(e),C.remove(),"OK"!==e.status)this._showErrorBox();else{let t=document.getElementById("payoneWorkOrder");t&&(t.value=e.workorderid),this._submitForm()}}_getValidateUrl(){return document.getElementById("payone-configuration").getAttribute("data-validate-url")}_showErrorBox(){let e=document.getElementById("payolutionErrorContainer");e&&(e.hidden=!1)}_hideErrorBox(){let e=document.getElementById("payolutionErrorContainer");e&&(e.hidden=!0)}_submitForm(){this.orderFormDisabled=!1,document.getElementById("confirmOrderForm").submit()}_getRequestData(){return{payoneBirthday:document.getElementById("payoneBirthday").value}}},"[data-is-payone-payolution-invoicing]"),T.register("PayonePaymentPayolutionInstallment",class extends o{init(){this.orderFormDisabled=!0,this._client=new w,this._disableSubmitButton(),this._registerEventListeners()}_registerEventListeners(){let e=document.getElementById("confirmOrderForm"),t=document.getElementById("checkInstallmentButton");e&&e.addEventListener("submit",this._handleOrderSubmit.bind(this)),t&&t.addEventListener("click",this._handleCalculationButtonClick.bind(this))}_handleCalculationButtonClick(e){if(this._hideErrorBox(),this._validateField(e,"payolutionConsent"),this._validateInput(e,"payoneBirthday"),e.defaultPrevented)return;C.create();let t=JSON.stringify(this._getRequestData());this._client.abort(),this._client.post(this._getCalculationUrl(),t,e=>this._handleCalculationCallback(e))}_handleCalculationCallback(e){if(e=JSON.parse(e),C.remove(),"OK"!==e.status){this._showErrorBox();return}let t=document.getElementById("payoneWorkOrder"),n=document.getElementById("payoneCartHash");t.value=e.workorderid,n.value=e.carthash,this._displayInstallmentSelection(e),this._displayCalculationOverview(e),this._registerSelectionEventListeners(),this._enableSecondStep(),this._activateSubmitButton(),this._hideCheckInstallmentButton()}_hideCheckInstallmentButton(){let e=document.getElementById("checkInstallmentButton");e&&e.classList.add("hidden")}_registerSelectionEventListeners(){document.getElementById("payolutionInstallmentDuration").addEventListener("change",function(e){let t=e.target.value;document.querySelectorAll(".installmentDetail").forEach(function(e){e.dataset.duration===t?e.hidden=!1:e.hidden="hidden"})})}_showErrorBox(){let e=document.getElementById("payolutionErrorContainer");e&&(e.hidden=!1)}_hideErrorBox(){let e=document.getElementById("payolutionErrorContainer");e&&(e.hidden=!0)}_enableSecondStep(){document.querySelectorAll(".payolution-installment .hidden").forEach(function(e){e.classList.remove("hidden")})}_displayInstallmentSelection(e){let t=document.getElementById("installmentSelection");t&&(t.innerHTML=e.installmentSelection)}_displayCalculationOverview(e){let t=document.getElementById("calculationOverview");t&&(t.innerHTML=e.calculationOverview)}_handleOrderSubmit(e){this._validateField(e,"payolutionConsent"),this._validateInput(e,"payoneBirthday"),this._validateInput(e,"payolutionAccountOwner"),this._validateInput(e,"payolutionIban"),this._validateInput(e,"payolutionBic"),this._validateInput(e,"payolutionInstallmentDuration")}_disableSubmitButton(){this.orderFormDisabled=!0;let e=document.getElementById("confirmFormSubmit");e&&e.setAttribute("disabled","disabled")}_activateSubmitButton(){this.orderFormDisabled=!1;let e=document.getElementById("confirmFormSubmit");e&&e.removeAttribute("disabled")}_getCalculationUrl(){return document.getElementById("payone-configuration").getAttribute("data-calculation-url")}_validateField(e,t){let n=document.getElementById(t);if(n.checked){n.classList.remove("is-invalid");return}n.scrollIntoView({block:"start",behavior:"smooth"}),n.classList.add("is-invalid"),this._handleOrderFormError(e)}_validateInput(e,t){let n=document.getElementById(t);if(n.value){n.classList.remove("is-invalid");return}n.scrollIntoView({block:"start",behavior:"smooth"}),n.classList.add("is-invalid"),this._handleOrderFormError(e)}_handleOrderFormError(e){let t=document.getElementById("confirmFormSubmit");if(e.preventDefault(),t){let e=new u(t);t.disabled=!1,e.remove()}}_getRequestData(){let e=document.getElementById("payoneBirthday"),t=document.getElementById("payoneWorkOrder"),n=document.getElementById("payoneCartHash");return{payoneBirthday:e.value,workorder:t.value,carthash:n.value}}},"[data-is-payone-payolution-installment]"),T.register("PayonePaymentApplePay",B,"[data-payone-payment-apple-pay-options]"),T.register("PayonePaymentRatepayInstallment",O,"[data-is-payone-ratepay-installment]"),T.register("PayonePaymentKlarna",P,"[data-payone-payment-klarna]"),T.register("PayonePaymentPayPalV2",k,"[data-payone-payment-pay-pal-v2-options]")})()})();